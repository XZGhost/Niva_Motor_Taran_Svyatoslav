"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8707],{3959:function(e,t,r){r.d(t,{r:function(){return a}});var n=r(75766),i=r(68949);class a{setBreakpoint(e){for(let t of(this.breakpoints.push({lineNumber:e}),this.debuggers))t.setBreakpoint(e)}removeBreakpoint(e){for(let t of(this.breakpoints=this.breakpoints.filter(t=>t.lineNumber!==e),this.debuggers))t.removeBreakpoint(e)}setActiveLine(e){this.activeLine=e}addDebugger(e){return this.debuggers.add(e),()=>this.debuggers.delete(e)}constructor(){(0,n._)(this,"activeLine",0),(0,n._)(this,"breakpoints",[]),(0,n._)(this,"debuggers",new Set),(0,i.ky)(this)}}},88707:function(e,t,r){r.d(t,{IK:function(){return b},d$:function(){return v},ir:function(){return p}});var n=r(38966),i=r.n(n),a=r(67090),s=r(98291),d=r(54619),l=r(23928),o=r(95700),u=r(3026),c=r(57564);function f(e){return""!==e?parseInt(e,8):0}var m=r(5301),h=r(3959);let g=a.V5.model({name:a.V5.string,size:a.V5.number,serverId:a.V5.maybe(a.V5.string)}).volatile(()=>({buffer:null,progress:0,modified:!1,uploading:!1,downloading:!1,uploadFailed:!1,abort:new AbortController})).views(e=>({get transferring(){return e.uploading||e.downloading}})).actions(e=>({updateProgress(t){e.progress=t},completeUpload(t){e.uploading=!1,t?e.serverId=t:(e.uploadFailed=!0,e.modified=!1)},setBuffer(t){e.buffer=null!=t?t:null,e.downloading=!1},setPristine(){e.modified=!1}})).actions(e=>({async upload(t,r){if(!e.serverId&&!e.uploading){(0,u.DT)(r).then(t=>e.setBuffer(t)),e.uploading=!0,e.modified=!0;try{let n=await (0,l.cT)(t,r,{abortSignal:e.abort.signal,onProgress:t=>e.updateProgress(t.loaded/t.total)});e.completeUpload(n.fileId)}catch(t){console.error(t),e.completeUpload()}}},async afterCreate(){if(e.serverId){e.downloading=!0;try{let t=await (0,l.Sv)(e.serverId,{abortSignal:e.abort.signal,onProgress:t=>e.updateProgress(t.loaded/e.size)});e.setBuffer(t)}catch(t){console.error(t),e.setBuffer()}}},beforeDestroy(){e.abort.abort()}})),p="sdcard/",v=a.V5.model({name:a.V5.string,content:a.V5.string}).volatile(e=>({originalName:e.name,originalContent:e.content,deleted:!1,editorState:null,errors:[],debugger:new h.r})).views(e=>({get type(){return(0,d.r5)(e.name)},get modified(){return e.content!==e.originalContent||e.originalName!==e.name}})).actions(e=>({update(t){e.content=t},rename(t){e.name=t},setPristine(){e.originalContent=e.content,e.originalName=e.name},setEditorState(t){e.editorState=t}})),b=a.V5.model({name:a.V5.optional(a.V5.string,""),id:a.V5.maybe(a.V5.string),parentId:a.V5.maybe(a.V5.string),files:a.V5.array(v),serverFiles:a.V5.array(g),owner:a.V5.maybe(a.V5.string),ownerUsername:a.V5.maybe(a.V5.string),locked:a.V5.maybe(a.V5.boolean),unlisted:a.V5.optional(a.V5.boolean,!1),updated:a.V5.maybe(a.V5.Date),hearts:a.V5.optional(a.V5.number,0),userLiked:a.V5.optional(a.V5.boolean,!1)}).volatile(()=>({binaryFiles:[],filesDeleted:!1,chips:[],diagramInstance:m.S0.create(),lastDiagramContent:"",tempId:"temp-".concat(Math.random().toString(36).substring(2))})).views(e=>({get diagram(){let r=e.files.find(e=>"diagram"===e.type);if(!r)return null;if((null==r?void 0:r.content)!==e.lastDiagramContent)try{var t;(0,a.Xx)(e.diagramInstance,JSON.parse(null!==(t=null==r?void 0:r.content)&&void 0!==t?t:"null")),e.lastDiagramContent||e.diagramInstance.undoManager.reset()}catch(e){return console.warn("Failed to parse diagram",e),null}return e.diagramInstance},get readme(){return e.files.find(e=>"readme"===e.type)},get modified(){return e.files.some(e=>e.modified)||e.serverFiles.some(e=>e.modified)||e.filesDeleted},findFile:t=>e.files.find(e=>e.name===t),get isDBProject(){return e.id&&/^[0-9]+$/.test(e.id)},get url(){return e.id?(0,d.gd)(e.id):null},get sdCardFiles(){return e.serverFiles.filter(e=>e.name.startsWith(p))}})).views(e=>({get architecture(){var t,r,n;let i=null===(t=e.diagram)||void 0===t?void 0:null===(r=t.board)||void 0===r?void 0:r.mcuType;return i&&(null===(n=o.v[i])||void 0===n?void 0:n.arch)},get projectType(){var i,a,s,d;let t=null===(i=null===(a=e.diagram)||void 0===a?void 0:a.findMCU())||void 0===i?void 0:i.attrs.get("env"),r=null===(s=null===(d=e.diagram)||void 0===d?void 0:d.findMCU())||void 0===s?void 0:s.attrs.get("builder");if(null==t?void 0:t.startsWith("kaluma"))return"kaluma";if(null==t?void 0:t.startsWith("micropython"))return"micropython";if(null==t?void 0:t.startsWith("circuitpython"))return"circuitpython";if(null==r?void 0:r.includes("rust"))return"rust";if((null==r?void 0:r.includes("sdk"))||(null==t?void 0:t.includes("zephyr")))return"sdk";return"arduino"}})).actions(e=>({addFile(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.files.find(e=>e.name===t);if(i){if(n)return i.update(r),i;throw Error("File ".concat(t," already exists in project"))}let a=e.files.push({name:t,content:r,modified:!0});return e.files[a-1]},addBinaryFile(t,r){e.binaryFiles.push({name:t,content:r})},updateFile(t,r){let n=e.files.find(e=>e.name===t);null==n||n.update(r)},renameFile(t,r){var n;null===(n=e.findFile(t))||void 0===n||n.rename(r),t.endsWith(".ino")&&t===e.name&&(e.name=r)},removeFile(t){let r=e.findFile(t);r&&(r.deleted=!0,e.files.remove(r),e.filesDeleted=!0)},uploadFile(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=n+(0,u.pC)(r),s=e.serverFiles.find(e=>e.name===i);s&&(0,a.ob)(s);let d=g.create({name:i,size:r.size});d.upload(t,r),e.serverFiles.push(d)},removeServerFile(e){(0,a.ob)(e)},setName(t){e.name=t},changeId(t){e.id=t},changeOwner(t){e.owner!==t&&(e.ownerUsername=void 0,e.owner=t)},setPristine(){e.files.forEach(e=>e.setPristine()),e.serverFiles.forEach(e=>e.setPristine()),e.filesDeleted=!1},setLocked(t){e.locked=t},setUnlisted(t){e.unlisted=t},updateHearts(t){e.hearts=t},updateUserLike(t){e.userLiked=t},setChips(t){e.chips=t},setGCCErrors(t,r){for(let t of e.files)t.errors=[];let{errors:n,remainingOutput:i}=(0,s.qK)(t),a=e.files[0];for(let t of Object.keys(n)){let r=e.files.find(e=>e.name===t);r?r.errors=n[t]:a.errors.push(...n[t])}(t=(0,s.zf)(i)).length>0&&!r&&a.errors.push({type:"error",startLineNumber:1,endLineNumber:1,endColumn:1,startColumn:1,message:t})},syncDiagram(){let{diagram:t}=e;if(t){var r,n;e.lastDiagramContent=i()({...n=(0,a.vM)(t),parts:(n.parts||[]).map(e=>{let t={...e};return t.hide||delete t.hide,t.rotate||delete t.rotate,t})},null,2,100),null===(r=e.findFile("diagram.json"))||void 0===r||r.update(e.lastDiagramContent)}return e.diagram}})).actions(e=>({async updateFromServer(t){if(!e.id)return;let{userLiked:r}=await (0,l._L)(t,e.id);e.updateUserLike(r)},async loadEgg(t){let n=r.e(2655).then(r.bind(r,27885)),i=await fetch("https://wokwi.com/api/external/hatchery?egg=".concat(encodeURIComponent(t))),a=await i.arrayBuffer(),s=(await n).inflate(a);for(let t of function*(e){let t=new c.B(e);for(;t.remaining>512;){let e=t.readChars(100),r=f(t.readChars(8)),n=f(t.readChars(8)),i=f(t.readChars(8)),a=f(t.readChars(12)),s=f(t.readChars(12)),d=f(t.readChars(8)),l=t.readChars(1),o=t.readChars(100),u=t.readChars(6),c=t.readChars(2),m="ustar"===u&&"00"===c,h=t.readChars(32),g=t.readChars(32),p=t.readChars(8),v=t.readChars(8),b=t.readChars(155);if(t.skip(12),!e&&!a&&!b)continue;let y=t.readBytes(a);a%512!=0&&t.skip(512-a%512),yield{name:m&&b?"".concat(b,"/").concat(e):e,mode:r,owner:n,group:i,size:a,lastModified:s,checksum:d,type:l,linkName:o,ownerName:m?h:"",groupName:m?g:"",devMajor:m?p:"",devMinor:m?v:"",data:y}}}(s)){let r="app/"+t.name.split("/").slice(1).join("/");if(r.endsWith(".png")||r.endsWith(".mpy"))e.addBinaryFile(r,t.data);else{let n=new TextDecoder().decode(t.data);e.files.find(e=>e.name===r)?e.updateFile(r,n):e.addFile(r,n)}}}}))},98291:function(e,t,r){r.d(t,{qK:function(){return d},zf:function(){return l},GS:function(){return s}});var n=r(20014);let i="/sketch/",a="sketch.ino";function s(e,t){return e.split(i+a).join(t)}function d(e){let t=[...(0,n.parseString)(e),...function(e){let t=/(\n|^)(\/sketch\/[^:/]+\.S):(\d+): (Warning|Error): (.+)(\s*\n|$)/g,r=[],n=t.exec(e);for(;n;)r.push({filename:n[2],line:parseInt(n[3],10),type:n[4].toLowerCase(),text:n[5],column:1,tokenLength:999,startIndex:n.index,endIndex:n.index+n[0].length}),t.lastIndex--,n=t.exec(e);return r}(e)],r={},s=null;r[a]=[],t.sort((e,t)=>e.startIndex==t.startIndex?"note"==e.type?1:-1:e.startIndex-t.startIndex);let d="";for(let n of t){var l,o,u;let{filename:t,line:c,column:f,tokenLength:m,text:h,type:g,startIndex:p,endIndex:v}=n,b=e.substring(null!==(o=null==s?void 0:s.endIndex)&&void 0!==o?o:0,p),y=/\r?\n?.+: In function '.+':\s*$/.exec(b),C=null!==(u=null==y?void 0:null===(l=y[0])||void 0===l?void 0:l.replace(/^\s*/g,""))&&void 0!==u?u:"";if(y&&(b=b.substr(0,y.index)),s?s.message+=b:d=b,"note"===g&&s&&s.startLineNumber===c&&s.startColumn===f){s.message+="\n"+h,s.endIndex=v;continue}if(t.startsWith(i)){let e=t.substring(i.length);s={type:g,startLineNumber:c,endLineNumber:c,startColumn:f,endColumn:f+(m||1),message:C+h,startIndex:p,endIndex:v},r[e]||(r[e]=[]),r[e].push(s)}else{let e=t.replace(/\/arduino\/hardware\/avr\/[0-9.]+\/cores/g,"");r[a].push({type:g,startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:1,message:"".concat(e,":").concat(c,": ").concat(C+h),startIndex:p,endIndex:v})}}return s&&(s.message+=e.substr(s.endIndex).replace(/Error during build: exit status 1/,"").replace(/\s+$/,"")),{errors:r,remainingOutput:d}}function l(e){let t=e.replace(/.+\n.+\n[ \t]*#\s*pragma message "FastLED version 3\.\d+\.\d+".*\n.+/,"").trim();return"Error during build: exit status 1"===t?"":t}},95700:function(e,t,r){r.d(t,{v:function(){return n}});let n={atmega328p:{arch:"avr",family:"avr"},atmega2560:{arch:"avr",family:"avr"},attiny85:{arch:"avr",family:"avr"},esp32:{arch:"xtensa",family:"esp32"},"esp32-s2":{arch:"xtensa",family:"esp32"},"esp32-s3":{arch:"riscv",family:"esp32"},"esp32-c3":{arch:"riscv",family:"esp32"},"esp32-c6":{arch:"riscv",family:"esp32"},rp2040:{arch:"arm",family:"rp2"},stm32c031c6:{arch:"arm",family:"stm32"},stm32f103c8:{arch:"arm",family:"stm32"},stm32l031k6:{arch:"arm",family:"stm32"},stm32l432kc:{arch:"arm",family:"stm32"}}},57564:function(e,t,r){r.d(t,{B:function(){return i}});var n=r(75766);class i{readUint8(){return this.buf[this.index++]}readUint16(){let{index:e}=this,t=this.buf[e],r=this.buf[e+1];return this.index+=2,r<<8|t}readUint32(){let{index:e}=this,t=this.buf[e],r=this.buf[e+1],n=this.buf[e+2],i=this.buf[e+3];return this.index+=4,(i<<24|n<<16|r<<8|t)>>>0}readInt32(){return 0|this.readUint32()}readBytes(e){let t=this.buf.subarray(this.index,this.index+e);return this.index+=e,t}readChars(e){let t=this.readBytes(e),r=t.indexOf(0);return r>=0&&(t=t.subarray(0,r)),this.decoder.decode(t)}readNullTerminated(){let e=this.buf.indexOf(0,this.index);e<0&&(e=this.buf.length);let t=this.decoder.decode(this.buf.subarray(this.index,e));return this.index=e+1,t}skip(e){this.index+=e}get currentOffset(){return this.index}get remaining(){let e=this.buf.length-this.index;return e>0?e:0}constructor(e){(0,n._)(this,"buf",void 0),(0,n._)(this,"index",void 0),(0,n._)(this,"decoder",void 0),this.buf=e,this.index=0,this.decoder=new TextDecoder}}}}]);