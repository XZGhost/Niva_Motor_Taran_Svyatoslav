(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7341],{20654:function(e,t,n){"use strict";n.d(t,{r:function(){return d}});var i=n(85893),r=n(41664),a=n.n(r),o=n(76149),l=n(99690),s=n(62042),c=n.n(s);function d(e){let{children:t}=e;return(0,i.jsx)("header",{children:(0,i.jsxs)("div",{className:c().toolbar,role:"banner",children:[(0,i.jsx)(a(),{href:"/",className:c().logo,children:(0,i.jsx)(l.F,{width:80,height:24})}),t,(0,i.jsx)("div",{className:c().spacer}),(0,i.jsx)("nav",{className:c().menu,children:(0,i.jsx)("a",{href:"https://docs.wokwi.com/?utm_source=wokwi",target:"_blank",children:"Docs"})}),(0,i.jsx)(o.I,{size:"small"})]})})}},29610:function(e,t,n){"use strict";n.d(t,{_:function(){return r}});var i=n(90948);let r=(0,i.ZP)("div")({display:"flex",flexDirection:"column",minHeight:"100vh"})},48500:function(e,t,n){"use strict";n.d(t,{i:function(){return m}});var i=n(85893),r=n(46670),a=n(11057),o=n(22237),l=n(50657),s=n(31425),c=n(6514),d=n(37645),u=n(23928),h=n(67294),p=n(4065);let m=(0,r.Pi)(e=>{let{project:t,isOpen:n,onClose:r}=e,m=(0,h.useContext)(p.St),[b,f]=(0,h.useState)(t.name),x=()=>{r()},g=()=>{b&&(t.setName(b),(0,u.ty)(m,t)),r()};return(0,i.jsx)(l.Z,{open:n,onClose:x,children:(0,i.jsxs)("form",{onSubmit:e=>{g(),e.preventDefault()},children:[(0,i.jsx)(d.Z,{children:"Rename Project"}),(0,i.jsx)(c.Z,{children:(0,i.jsx)(o.Z,{autoFocus:!0,margin:"dense",id:"name",label:"Project Name",value:b,fullWidth:!0,variant:"outlined",onChange:e=>{f(e.target.value)}})}),(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(a.Z,{color:"inherit",onClick:x,children:"Cancel"}),(0,i.jsx)(a.Z,{variant:"contained",disabled:0===b.length,onClick:g,children:"Rename"})]})]})})})},10621:function(e,t,n){"use strict";n.d(t,{m:function(){return t0}});var i=n(85893),r=n(55317),a=n(8849),o=n.n(a),l=n(95617),s=n(19620),c=n(75862),d=n(38043),u=n(51797),h=n(18972),p=n(99226),m=n(59334),b=n(50480),f=n(69368),x=n(11057),g=n(34386),v=n(93946),j=n(13264),k=n(46670),y=n(9008),w=n.n(y),_=n(41664),S=n.n(_),C=n(11163),Z=n.n(C),P=n(67294),D=n(25854),L=n(2656),T=n(4065),I=n(19469),E=n(92920),A=n(23928),N=n(84153),F=n(45111),M=n(56863),U=n(25464);let W=(0,P.createContext)(null),R=(0,j.Z)(x.Z)({minWidth:"28px",padding:"4px 0"});function O(e){let{text:t,children:n,variant:r,...a}=e,[o,l]=(0,P.useState)(!1),s=(0,P.useRef)(null),c=()=>l(!1);return(0,i.jsxs)(W.Provider,{value:{closeMenu:c},children:[(0,i.jsxs)(M.Z,{variant:r,ref:s,children:[(0,i.jsx)(x.Z,{variant:r,...a,children:t}),(0,i.jsx)(R,{size:"small",onClick:()=>l(!0),variant:r,children:(0,i.jsx)(F.Z,{})})]}),(0,i.jsx)(U.Z,{open:o,onClose:c,anchorEl:s.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:n})]})}function B(e){let{children:t}=e,n=(0,P.useContext)(W);return(0,i.jsx)("div",{onClick:()=>{null==n||n.closeMenu()},children:t})}var z=n(85940),G=n(20654),H=n(29610),q=n(48500),X=n(26447),V=n(15861),K=n(50657),Y=n(31425),J=n(6514),Q=n(37645),$=n(22237),ee=n(94054),et=n(40476),en=n(68061),ei=n(36872),er=n(89055),ea=n(94532);let eo=(0,k.Pi)(e=>{let{privacy:t,onPrivacyChange:n}=e,r=(0,P.useContext)(T.St);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ee.Z,{margin:"normal",children:[(0,i.jsx)(et.Z,{id:"privacy-radio-buttons-group",children:"Project privacy:"}),(0,i.jsxs)(en.Z,{"aria-labelledby":"privacy-radio-buttons-group",name:"controlled-radio-buttons-group",value:t,onChange:e=>n(e.target.value),children:[(0,i.jsx)(b.Z,{value:"public",control:(0,i.jsx)(ei.Z,{}),label:(0,i.jsxs)(X.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,i.jsx)(p.Z,{minWidth:60,children:"Public"}),(0,i.jsx)(er.Z,{fontSize:"small"})]})}),(0,i.jsx)(b.Z,{value:"unlisted",control:(0,i.jsx)(ei.Z,{}),label:(0,i.jsxs)(X.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,i.jsx)(p.Z,{minWidth:60,children:"Unlisted"}),(0,i.jsx)(ea.Z,{fontSize:"small"})]})})]})]}),"unlisted"===t&&!r.club&&(0,i.jsxs)(V.Z,{children:["In order to save as unlisted, ",(0,i.jsx)("br",{}),"please join the Wokwi Club. ",(0,i.jsx)("br",{}),(0,i.jsx)(x.Z,{variant:"outlined",color:"secondary",href:"https://wokwi.com/club",target:"_blank",onClick:()=>(0,I.c)("club:learnMore:unlistedSave"),sx:{marginTop:1},children:"Learn more"})]})]})}),el=(0,k.Pi)(e=>{var t;let{project:n,isOpen:r,onClose:a,onSaveCopyClick:o}=e,[l,s]=(0,P.useState)(""),c=(0,P.useContext)(T.St),[d,u]=(0,P.useState)("public");(0,P.useEffect)(()=>{s(n.name+" Copy")},[n.name]);let h=()=>{a()},p=()=>{l&&(n.setUnlisted("unlisted"===d),o(l),a())};return(0,i.jsx)(K.Z,{open:r,onClose:h,children:(0,i.jsxs)("form",{onSubmit:e=>{p(),e.preventDefault()},children:[(0,i.jsx)(Q.Z,{children:"Save a Copy"}),(0,i.jsx)(J.Z,{children:(0,i.jsxs)(X.Z,{children:[n.owner&&n.owner!==c.id&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(V.Z,{children:["This project is owned by ",null!==(t=n.ownerUsername)&&void 0!==t?t:"a different user","."]}),(0,i.jsx)(V.Z,{gutterBottom:!0,children:"You can save a copy of this project in your account."})]}),(0,i.jsx)($.Z,{autoFocus:!0,margin:"dense",id:"name",label:"Project Name",value:l,fullWidth:!0,variant:"outlined",onChange:e=>{s(e.target.value)}}),(0,i.jsx)(eo,{privacy:d,onPrivacyChange:u})]})}),(0,i.jsxs)(Y.Z,{children:[(0,i.jsx)(x.Z,{color:"inherit",onClick:h,children:"Cancel"}),(0,i.jsx)(x.Z,{variant:"contained",disabled:0===l.length||"unlisted"===d&&!c.club,onClick:p,children:"Save Copy"})]})]})})}),es=(0,k.Pi)(e=>{let{project:t,isOpen:n,onClose:r,onSaveClick:a}=e,[o,l]=(0,P.useState)(t.name),[s,c]=(0,P.useState)("public"),d=()=>{r()},u=()=>{o&&(t.setUnlisted("unlisted"===s),a(o),r())},h=(0,P.useContext)(T.St);return(0,i.jsx)(K.Z,{open:n,onClose:d,children:(0,i.jsxs)("form",{onSubmit:e=>{u(),e.preventDefault()},children:[(0,i.jsx)(Q.Z,{children:"Save Your Project"}),(0,i.jsx)(J.Z,{children:(0,i.jsxs)(X.Z,{children:[(0,i.jsx)($.Z,{autoFocus:!0,margin:"dense",id:"name",label:"Project Name",value:o,fullWidth:!0,variant:"outlined",onChange:e=>{l(e.target.value)}}),(0,i.jsx)(eo,{privacy:s,onPrivacyChange:c})]})}),(0,i.jsxs)(Y.Z,{children:[(0,i.jsx)(x.Z,{color:"inherit",onClick:d,children:"Cancel"}),(0,i.jsx)(x.Z,{variant:"contained",disabled:0===o.length||"unlisted"===s&&!h.club,onClick:u,children:"Save"})]})]})})});var ec=n(68698),ed=n(95384),eu=n.n(ed);function eh(e){let{link:t}=e,{translate:n}=(0,D.q)("project.shareDialog"),a=(0,P.useRef)(null),l=e=>{var t;null===(t=a.current)||void 0===t||t.select(),document.execCommand("copy"),e.target.focus()};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{type:"text",value:t,ref:a,readOnly:!0,onClick:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.select()}}),(0,i.jsx)(g.Z,{title:n("copyToClipboard","Copy to clipboard"),children:(0,i.jsx)(v.Z,{onClick:l,children:(0,i.jsx)(o(),{path:r._U3,size:1})})})]})}function ep(e){var t;let{open:n,onClose:a,project:l,saving:s,onSaveProject:c}=e,{translate:d}=(0,D.q)("project.shareDialog");return(0,i.jsxs)(K.Z,{open:n,onClose:a,classes:{paper:eu().modalContent},children:[(0,i.jsx)(ec.P,{onClose:a}),(0,i.jsx)(Q.Z,{children:d("title","Share Project")}),(0,i.jsx)(J.Z,{children:(null==l?void 0:l.url)?(0,i.jsx)("div",{className:eu().shareLinkContainer,children:(0,i.jsx)(eh,{link:null!==(t=l.url)&&void 0!==t?t:""})}):(0,i.jsxs)(V.Z,{children:[d("pleaseSave","To share this project, please save it first:"),(0,i.jsx)(p.Z,{mt:2,children:(0,i.jsx)(x.Z,{variant:"contained",startIcon:s?(0,i.jsx)(o(),{path:r.CEZ,size:1,spin:!0}):(0,i.jsx)(o(),{path:r.Tls,size:1}),onClick:c,children:d("saveProject","Save project")})})]})}),(0,i.jsx)(Y.Z,{children:(0,i.jsx)(x.Z,{onClick:a,children:d("closeButton","Close")})})]})}var em=n(16264),eb=n(1222),ef=n(70062),ex=n(48885),eg=n(78462),ev=n(70891),ej=n(88707),ek=n(3026),ey=n(48913);let ew=(0,k.Pi)(e=>{let{show:t,onHide:n}=e;return(0,i.jsxs)(K.Z,{open:t,onClose:n,"aria-labelledby":"form-dialog-title",maxWidth:"md",children:[(0,i.jsx)(Q.Z,{id:"form-dialog-title",children:"Hmm... Join the club?"}),(0,i.jsx)(J.Z,{children:"File upload is only available to Wokwi Club members."}),(0,i.jsxs)(Y.Z,{children:[(0,i.jsx)(x.Z,{variant:"outlined",onClick:n,sx:{margin:1},children:"Close"}),(0,i.jsx)(x.Z,{variant:"contained",href:"/club",target:"_blank",children:"Learn more"})]})]})});var e_=n(46761),eS=n(26576),eC=n(98456);function eZ(e){var t;return(0,i.jsxs)(p.Z,{sx:{position:"relative",display:"inline-flex"},children:[(0,i.jsx)(eC.Z,{variant:"determinate",...e}),(0,i.jsx)(p.Z,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(V.Z,{variant:"caption",component:"div",color:"text.secondary",children:"".concat(Math.round(null!==(t=e.value)&&void 0!==t?t:100),"%")})})]})}let eP=(0,k.Pi)(e=>{let{file:t,onRemove:n}=e,r=t.name.substring(ej.ir.length);return(0,i.jsxs)(ev.ZP,{secondaryAction:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(v.Z,{onClick:()=>n(t),children:(0,i.jsx)(e_.Z,{})})}),children:[(0,i.jsx)(m.Z,{primary:r,secondary:"".concat(t.size," bytes"),sx:{marginRight:1}}),t.transferring&&(0,i.jsx)(eZ,{value:Math.floor(100*t.progress)}),t.uploadFailed&&(0,i.jsx)(g.Z,{title:"Upload failed",children:(0,i.jsx)(eS.Z,{color:"error"})})]})}),eD=(0,k.Pi)(()=>{let e=(0,em.a)(),t=(0,ey.P)(),{translate:n}=(0,D.q)("editor.sdCard"),[r,a]=(0,P.useState)(!1),o=async n=>{if(!e.club){a(!0);return}let{files:i}=await (0,ek.aE)(n?{directory:!0}:{multiple:!0});for(let n of i)t.uploadFile(e,n,ej.ir)},l=()=>{for(let e of Array.from(t.serverFiles))t.removeServerFile(e)},s=e=>t.removeServerFile(e),{sdCardFiles:c}=t;return(0,i.jsxs)(p.Z,{display:"flex",flexDirection:"column",flex:1,height:0,children:[(0,i.jsx)(ew,{show:r,onHide:()=>a(!1)}),(0,i.jsxs)(p.Z,{p:1,children:[(0,i.jsx)(O,{text:n("uploadFiles","Upload files"),variant:"contained",onClick:()=>o(!1),children:(0,i.jsx)(B,{children:(0,i.jsxs)(h.Z,{onClick:()=>o(!0),children:[(0,i.jsx)(ex.Z,{children:(0,i.jsx)(ef.Z,{fontSize:"small"})}),(0,i.jsx)(m.Z,{children:n("uploadCompleteFolder","Upload complete folder")})]})})}),(0,i.jsx)(x.Z,{variant:"outlined",sx:{marginLeft:1},onClick:l,children:n("uploadCompleteFolder","Delete all files")})]}),(0,i.jsxs)(eg.Z,{sx:{flex:1,bgcolor:"background.paper",overflow:"auto"},children:[!c.length&&(0,i.jsx)(ev.ZP,{children:(0,i.jsx)(m.Z,{primary:n("noFilesYet","No files yet. Please upload some files.")})}),c.map(e=>(0,i.jsx)(eP,{file:e,onRemove:s},e.name))]})]})});var eL=n(5301),eT=n(68949),eI=n(37018),eE=n(86954),eA=n(8853),eN=n(27039);let eF="i2c-counter.chip.c",eM='\n// Wokwi Custom Chip - For information and examples see:\n// https://docs.wokwi.com/chips-api/getting-started\n//\n// SPDX-License-Identifier: MIT\n// Copyright (C) 2022 Uri Shaked / wokwi.com\n\n#include "wokwi-api.h"\n#include <stdio.h>\n#include <stdlib.h>\n\nconst int ADDRESS = 0x22;\n\ntypedef struct {\n  pin_t pin_int;\n  uint8_t counter;\n  uint32_t threshold_attr;\n} chip_state_t;\n\nstatic bool on_i2c_connect(void *user_data, uint32_t address, bool connect);\nstatic uint8_t on_i2c_read(void *user_data);\nstatic bool on_i2c_write(void *user_data, uint8_t data);\nstatic void on_i2c_disconnect(void *user_data);\n\nvoid chip_init() {\n  chip_state_t *chip = malloc(sizeof(chip_state_t));\n\n  chip->pin_int = pin_init("INT", INPUT);\n  chip->counter = 0;\n\n  const i2c_config_t i2c_config = {\n    .user_data = chip,\n    .address = ADDRESS,\n    .scl = pin_init("SCL", INPUT),\n    .sda = pin_init("SDA", INPUT),\n    .connect = on_i2c_connect,\n    .read = on_i2c_read,\n    .write = on_i2c_write,\n    .disconnect = on_i2c_disconnect, // Optional\n  };\n  i2c_init(&i2c_config);\n\n  // This attribute can be edited by the user. It\'s defined in wokwi-custom-part.json:\n  chip->threshold_attr = attr_init("threshold", 127);\n\n  // The following message will appear in the browser\'s DevTools console:\n  printf("Hello from custom chip!\\n");\n}\n\nstatic void counter_updated(chip_state_t *chip) {\n  const uint32_t threshold = attr_read(chip->threshold_attr);\n  if (chip->counter > threshold) {\n    pin_write(chip->pin_int, LOW);\n    pin_mode(chip->pin_int, OUTPUT);\n  } else {\n    pin_mode(chip->pin_int, INPUT);\n  }\n}\n\nbool on_i2c_connect(void *user_data, uint32_t address, bool connect) {\n  return true; /* Ack */\n}\n\nuint8_t on_i2c_read(void *user_data) {\n  chip_state_t *chip = user_data;\n  chip->counter++;\n  counter_updated(chip);\n  return chip->counter;\n}\n\nbool on_i2c_write(void *user_data, uint8_t data) {\n  chip_state_t *chip = user_data;\n  chip->counter = data;\n  counter_updated(chip);\n  return true; // Ack\n}\n\nvoid on_i2c_disconnect(void *user_data) {\n  // Do nothing\n}\n'.trim()+"\n",eU="i2c-counter.chip.json",eW=JSON.stringify({name:"I2C Counter",author:"Uri Shaked",pins:["INT","SCL","SDA","GND","VCC","","","","",""],controls:[{id:"threshold",label:"LED Threshold",type:"range",min:1,max:255,step:1}]},null,2);var eR=n(61478),eO=n(97763),eB=n(69246),ez=n(3341),eG=n(53113),eH=n(72428),eq=n(58032),eX=n(14564),eV=n(75438),eK=n(18335),eY=n(54499),eJ=n(54619),eQ=n(96506),e$=n(52149),e0=n(42293),e1=n(79332),e2=n(87109),e3=n(84118),e6=n(81458),e4=n(95591),e5=n(9764),e8=n(86010);let e7=e=>fetch(e).then(e=>e.json()),e9=(0,k.Pi)(e=>{var t;let{onAddLibrary:n,onUploadLibrary:r}=e,{data:a,error:o}=(0,e4.ZP)("https://libraries.wokwi.workers.dev/list",e7),[l,s]=(0,P.useState)(""),[c,d]=(0,P.useState)(-1),u=(0,P.useRef)(null),m=(0,P.useRef)(null),b=(0,P.useRef)(null);if(o)return(0,i.jsx)(p.Z,{p:1,children:(0,i.jsx)(V.Z,{children:"Error loading library index :-("})});let f=l.trim().toLowerCase(),g=f&&null!==(t=null==a?void 0:a.libraries.filter(e=>e.toLowerCase().includes(f)))&&void 0!==t?t:[],v=e=>{let t=g.length-1;switch(e){case"ArrowUp":return Math.max(0,c-1);case"ArrowDown":return Math.min(t,c+1);case"PageUp":return Math.max(0,c-12);case"PageDown":return Math.max(0,c+12);default:return null}},j=e=>{let t=v(e.code);if(null!=t){var n;null===(n=m.current)||void 0===n||n.scrollIntoView({index:t,behavior:"auto",done:()=>d(t)}),e.preventDefault()}},k=e=>{e instanceof HTMLElement&&(e.addEventListener("keydown",j),b.current=()=>e.removeEventListener("keydown",j))};return(0,i.jsxs)(p.Z,{p:2,minWidth:300,children:[(0,i.jsxs)(e0.Z,{position:"sticky",onFocus:()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.focus()},children:[(0,i.jsx)(e1.Z,{autoFocus:!0,ref:u,value:l,onChange:e=>s(e.target.value),onClick:e=>e.stopPropagation(),sx:{width:"100%"},onKeyDown:e=>{if("Enter"===e.key){let t=c>=0&&g[c];t&&(n(t),e.preventDefault())}else("ArrowDown"===e.key||"ArrowUp"===e.key||"PageUp"===e.key||"PageDown"==e.key)&&(j(e),e.preventDefault())},endAdornment:(0,i.jsx)(e2.Z,{position:"end",children:(0,i.jsx)(eQ.Z,{})})})," "]}),(0,i.jsxs)(e3.Z,{children:[f&&!a&&(0,i.jsxs)(p.Z,{py:2,children:[(0,i.jsx)(V.Z,{children:"Loading library index..."}),(0,i.jsx)(e6.Z,{})]}),g.length>0&&(0,i.jsx)(e5.OO,{style:{height:"400px",maxHeight:"100%"},data:g,ref:m,scrollerRef:k,itemContent:(e,t)=>(0,i.jsx)(h.Z,{onClick:()=>n(t),className:(0,e8.default)(e===c&&"Mui-focusVisible"),children:t},t)}),f&&!g.length&&(0,i.jsx)(V.Z,{color:"gray",children:"No libraries found"}),!f&&(0,i.jsx)(V.Z,{color:"gray",children:"Type some text to search for libraries"})]}),!f&&(0,i.jsx)(x.Z,{startIcon:(0,i.jsx)(e$.Z,{}),onClick:r,children:"Upload a library"})]})}),te="wokwi:";var tt=n(39702),tn=n(57322),ti=n(69661);let tr=(0,k.Pi)(e=>{let{library:t,onRemoveLibrary:n}=e,[r,a]=t.split("@"),o=null==a?void 0:a.startsWith(te),l=r+".zip",s=null==a?void 0:a.substring(te.length),c="https://wokwi.com/storage/libs/".concat(s,"/").concat(l);return(0,i.jsxs)(ev.ZP,{secondaryAction:(0,i.jsxs)(i.Fragment,{children:[o&&(0,i.jsx)("a",{href:c,download:!0,children:(0,i.jsx)(v.Z,{children:(0,i.jsx)(tt.Z,{})})}),(0,i.jsx)(v.Z,{onClick:n,children:(0,i.jsx)(e_.Z,{})})]}),children:[(0,i.jsx)(ex.Z,{children:(0,i.jsx)(ti.Z,{children:(0,i.jsx)(tn.Z,{})})}),(0,i.jsx)(m.Z,{primary:o?l:r})]})});var ta=n(95944);let to=(0,k.Pi)(e=>{let{uploadState:t}=e,{translate:n}=(0,D.q)("project.libManager.uploadDialog"),r=()=>t.abort();return(0,i.jsxs)(K.Z,{open:t.uploading,onClose:r,"aria-labelledby":"form-dialog-title",maxWidth:"md",children:[(0,i.jsx)(Q.Z,{id:"form-dialog-title",children:n("title","Uploading library...")}),(0,i.jsx)(J.Z,{children:(0,i.jsx)(ta.y,{value:100*t.progress})}),(0,i.jsx)(Y.Z,{children:(0,i.jsx)(x.Z,{onClick:r,children:n("cancelButton","Cancel")})})]})});var tl=n(75766);class ts{async startUpload(e,t){this.uploading=!0,this.abortController=new AbortController;let n=await (0,A.jI)(e,t,{abortSignal:this.abortController.signal,onProgress:e=>this.updateProgress(e.loaded/e.total)}),i=this.abortController.signal.aborted;return(this.finishUpload(),i)?null:null!=n?n:null}updateProgress(e){this.progress=e}finishUpload(){this.uploading=!1,this.abortController=void 0}abort(){var e;this.uploading=!1,null===(e=this.abortController)||void 0===e||e.abort()}constructor(){(0,tl._)(this,"uploading",!1),(0,tl._)(this,"progress",0),(0,tl._)(this,"abortController",void 0),(0,eT.ky)(this)}}let tc=(0,k.Pi)(()=>{var e,t;let n=(0,ey.P)(),r=(0,em.a)(),a=(0,P.useRef)(null),[o,l]=(0,P.useState)(!1),[s,c]=(0,P.useState)(!1),[d]=(0,P.useState)(new ts),u=Array.from((0,eY.h)(null!==(t=null===(e=n.findFile(eJ.vW))||void 0===e?void 0:e.content)&&void 0!==t?t:"")),h=()=>{let e=n.findFile(eJ.vW);if(e)return e;let t=n.files.filter(e=>"sketch"===(0,eJ.r5)(e.name)),i=t.flatMap(e=>(0,eK.h7)(e.content)).map(e=>eY.i[e]).filter(e=>e),r=["# Wokwi Library List","# See https://docs.wokwi.com/guides/libraries",""],a=!1;for(let e of i)a||(r.push("# Automatically added based on includes:"),a=!0),r.push(e);return a&&r.push(""),n.addFile(eJ.vW,r.join("\n")+"\n")},b=e=>{let t=h(),n=t.content;n.endsWith("\n")||(n+="\n"),n+=e,t.update(n),l(!1)},f=e=>{let t=h(),n=t.content.split("\n").filter(t=>t.trim().split("@")[0]!==e).join("\n");t.update(n)},x=async()=>{if(!r.club){c(!0);return}let{files:e}=await (0,ek.aE)({directory:!0}),t=Array.from(e).filter(A.kn);if(!t.length){alert("Invalid library: no source files (.c, .cpp, .h) found!");return}let n=await d.startUpload(r,t);n&&(f(n.libraryName),b("".concat(n.libraryName,"@").concat(te).concat(n.fileId)))};return(0,i.jsxs)(p.Z,{display:"flex",flexDirection:"column",flex:1,height:0,position:"relative",children:[(0,i.jsx)(to,{uploadState:d}),(0,i.jsx)(ew,{show:s,onHide:()=>c(!1)}),(0,i.jsxs)(p.Z,{p:1,children:[(0,i.jsx)(V.Z,{variant:"h5",component:"h2",children:"Project Libraries"}),(0,i.jsx)(g.Z,{title:"Add a new library",children:(0,i.jsx)(eq.Z,{color:"primary",size:"medium",ref:a,onClick:()=>l(!0),sx:{position:"absolute",top:16,right:16,zIndex:10},children:(0,i.jsx)(eH.Z,{})})}),(0,i.jsx)(eX.ZP,{open:o,anchorEl:a.current,onClose:()=>l(!1),onClick:()=>l(!1),onKeyDown:e=>{"Enter"===e.key&&(l(!1),e.stopPropagation())},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,i.jsx)(e9,{onAddLibrary:b,onUploadLibrary:x})})]}),(0,i.jsxs)(eg.Z,{sx:{flex:1,bgcolor:"background.paper",overflow:"auto"},"aria-labelledby":"nested-list-subheader",subheader:(0,i.jsx)(eV.Z,{component:"div",id:"nested-list-subheader",children:"Installed Libraries"}),children:[!u.length&&(0,i.jsx)(ev.ZP,{children:(0,i.jsx)(m.Z,{children:"No libraries installed."})}),u.map(e=>(0,i.jsx)(tr,{library:e,onRemoveLibrary:()=>f(e.split("@")[0])},e))]})]})});var td=n(59130),tu=n(89022),th=n(66442),tp=n(93545),tm=n(87260),tb=n(6593),tf=n(48053),tx=n(24889),tg=n.n(tx);function tv(e){let t=[],{items:n}=e;for(let e=0;e<4;e++)e<n.length?t.push((0,tm.MS)(n[e])):t.push("        ");return e.empty&&(t[0]="<EMPTY> "),t.join(" ")}let tj=(0,k.Pi)(()=>{let[e,t]=(0,P.useState)(0),[n,r]=(0,P.useState)(0),[,a]=(0,P.useState)(0),o=(0,P.useContext)(tf.D),l=o.tempRunner,s=l.cpu,c=l.pioRunners[e],{instructions:d,machines:u}=s.pio[e],h=u[n],p=h.pc,m=(0,P.useMemo)(()=>(0,tp.C)(d,(0,tp.k)(h.pinCtrl)),[d,h]),b=function(){let[,e]=(0,P.useState)(0),t=(0,P.useCallback)(()=>{e(e=>e+1)},[]);return t}();(0,P.useEffect)(()=>{let e=setInterval(()=>{a(h.cycles)},100);return()=>clearInterval(e)},[h]);let f=()=>{o.paused?o.resume():o.pause()},g=()=>{s.pio[e].step(),o.forceUpdate(),a(h.cycles)},v=e=>{"n"===e.key.toLowerCase()&&(g(),e.preventDefault())},j=(0,P.useMemo)(()=>{if(!h.enabled)return"STOP";if(!h.waiting)return"RUN";let e=h.waitPolarity?"1":"0";switch(h.waitType){case 1:return"WAIT ".concat(e," PIN ").concat(h.waitIndex);case 2:return"WAIT RXFIFO";case 3:case 5:return"WAIT TXFIFO";case 4:return"WAIT ".concat(e," IRQ ").concat(h.waitIndex);default:return""}},[h.waitType,h.waitPolarity,h.waitIndex,h.waiting,h.enabled]);return(0,i.jsxs)("div",{className:tg().debugger,onKeyPress:v,children:[(0,i.jsxs)("div",{children:["Wokwi PIO Debugger"," ",(0,i.jsxs)(M.Z,{size:"small",children:[(0,i.jsx)(x.Z,{onClick:f,children:o.paused?(0,i.jsx)(td.Z,{}):(0,i.jsx)(tu.Z,{})}),(0,i.jsx)(x.Z,{disabled:!o.running||!o.paused,children:(0,i.jsx)(th.Z,{onClick:g})})]})," ","PIO:"," ",(0,i.jsxs)(M.Z,{size:"small",children:[(0,i.jsx)(x.Z,{onClick:()=>t(0),variant:0===e?"contained":"outlined",children:"0"}),(0,i.jsx)(x.Z,{onClick:()=>t(1),variant:1===e?"contained":"outlined",children:"1"})]}),"Machine:",(0,i.jsxs)(M.Z,{size:"small",children:[(0,i.jsx)(x.Z,{onClick:()=>r(0),variant:0===n?"contained":"outlined",children:"0"}),(0,i.jsx)(x.Z,{onClick:()=>r(1),variant:1===n?"contained":"outlined",children:"1"}),(0,i.jsx)(x.Z,{onClick:()=>r(2),variant:2===n?"contained":"outlined",children:"2"}),(0,i.jsx)(x.Z,{onClick:()=>r(3),variant:3===n?"contained":"outlined",children:"3"})]})]}),(0,i.jsx)("div",{className:tg().listing,children:m.map(e=>(0,i.jsxs)("pre",{className:(0,e8.default)(e.address===p&&tg().current),children:[(0,i.jsx)("input",{title:"Breakpoint","aria-label":"Breakpoint",type:"checkbox",checked:!!(c.breakpoints&1<<e.address),className:(0,e8.default)(tg().breakpoint),onChange:()=>{c.breakpoints^=1<<e.address,b()}}),(0,i.jsx)("span",{className:tg().lineNumber,children:(0,tb.Gt)(e.address,2," ")}),(0,i.jsx)("span",{children:e.text})]},e.address))}),(0,i.jsxs)("div",{className:tg().registers,children:["Registers: X ",(0,tm.MS)(h.x)," Y ",(0,tm.MS)(h.y)," ISR ",(0,tm.MS)(h.inputShiftReg)," [",(0,i.jsx)("span",{children:(0,tb.Gt)(h.inputShiftCount,2," ")}),"] OSR"," ",(0,tm.MS)(h.outputShiftReg)," [",(0,i.jsx)("span",{children:(0,tb.Gt)(h.outputShiftCount,2," ")}),"] CYCLES ",(0,i.jsx)("span",{children:(0,tb.Gt)(h.cycles,8," ")})," ",j,(0,i.jsx)("br",{}),"RX: ",(0,i.jsx)("span",{className:tg().fifo,children:tv(h.rxFIFO)}),"TX: ",(0,i.jsx)("span",{className:tg().fifo,children:tv(h.txFIFO)})]})]})});async function tk(e,t,n){e.removeFile(A.rp);let{hex:i,hexError:r}=await t.build({...n,files:e.files,diagram:e.diagram||eL.S0.create(),listing:!0});if(r){console.error(r),alert("Error connecting to build server: "+r);return}if(!(null==i?void 0:i.listing)){console.log(null==i?void 0:i.stderr),alert("Build failed!");return}let a=e.findFile(A.rp);a?(a.update(i.listing),a.setPristine()):e.addFile(A.rp,i.listing)}var ty=n(96682),tw=n(56838),t_=n(8107),tS=n.n(t_),tC=n(8240),tZ=n(67449),tP=n.n(tZ);let tD=(0,k.Pi)(()=>{let e=(0,P.useContext)(tf.D);return e.running&&e.debuggerEnabled?(0,i.jsxs)("div",{className:tP().debugBar,children:[e.paused?(0,i.jsx)(g.Z,{title:"Resume program",children:(0,i.jsx)("i",{className:(0,e8.default)(tP().button,"codicon codicon-debug-continue"),onClick:()=>e.resume()})}):(0,i.jsx)(g.Z,{title:"Pause program",children:(0,i.jsx)("i",{className:(0,e8.default)(tP().button,"codicon codicon-debug-pause"),onClick:()=>e.pause()})}),(0,i.jsx)(g.Z,{title:"Step over",children:(0,i.jsx)("i",{className:(0,e8.default)(tP().button,!e.paused&&tP().disabled,"codicon codicon-debug-step-over"),onClick:()=>e.stepOver()})}),(0,i.jsx)(g.Z,{title:"Step into",children:(0,i.jsx)("i",{className:(0,e8.default)(tP().button,!e.paused&&tP().disabled,"codicon codicon-debug-step-into"),onClick:()=>e.stepInto()})}),(0,i.jsx)(g.Z,{title:"Step out (run until return)",children:(0,i.jsx)("i",{className:(0,e8.default)(tP().button,!e.paused&&tP().disabled,"codicon codicon-debug-step-out"),onClick:()=>e.stepOut()})})]}):null});var tL=n(41264),tT=n.n(tL),tI=n(43324),tE=n(62510),tA=n(51418),tN=n(16765);let tF=(0,tC.N)().dark,tM=(0,k.Pi)(e=>{var t,n;let{diagram:r,readme:a,files:o}=e,[l,s]=(0,P.useState)(0),{translate:c}=(0,D.q)("simulator.tabs");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(tN.mQ,{children:[(0,i.jsx)(tN.OK,{onClick:()=>s(0),active:0===l,children:c("simulation","Simulation")}),(null===(t=null==a?void 0:a.content.trim())||void 0===t?void 0:t.length)?(0,i.jsx)(tN.OK,{onClick:()=>s(1),active:1===l,children:c("description","Description")}):null]}),0===l&&r&&(0,i.jsx)(tA.u,{diagram:r,files:o}),1===l&&(0,i.jsx)("section",{className:(0,e8.default)("markdown-body",tF&&"dark"),children:(0,i.jsx)(tI.D,{remarkPlugins:[tE.Z],children:null!==(n=null==a?void 0:a.content)&&void 0!==n?n:""})}),(0,i.jsx)("style",{children:"\n        .markdown-body {\n          background: #eee;\n          color: black;\n          overflow: auto; /* Enable scrolling */\n          padding: 1.5em;\n          min-height: 100%;\n        }\n        .markdown-body.dark {\n          background: #111;\n          color: inherit;\n        }\n        .markdown-body.dark a {\n          color: #88f;\n        }\n        .markdown-body.dark pre {\n          background: #333;\n        }\n\n        .markdown-body::-webkit-scrollbar {\n          height: 16px;\n          width: 16px;\n        }\n\n        .markdown-body::-webkit-scrollbar-thumb,\n        .markdown-body::-webkit-scrollbar-track {\n          border: 4px solid transparent;\n          border-radius: 8px;\n          background-clip: padding-box;\n        }\n\n        .markdown-body::-webkit-scrollbar-thumb {\n          min-height: 40px;\n        }\n        .markdown-body.dark::-webkit-scrollbar-thumb {\n          background-color: #3d3a3a;\n        }\n\n        .markdown-body::-webkit-scrollbar-track {\n          margin-bottom: 8px;\n        }\n        .markdown-body.dark::-webkit-scrollbar-track {\n          background-color: #2a2a2a;\n        }\n\n        .markdown-body.dark table {\n          color: black;\n        }\n      "})]})}),tU=(0,k.Pi)(e=>{let{project:t,files:n}=e,r=(0,P.useContext)(z.r),{ref:a,width:o=1,height:l=1}=tS()(),[s,c]=(0,P.useState)(""),d=(0,ty.Z)();(0,P.useEffect)(()=>{"diagram"===(0,tC.N)().view&&c("diagram")},[]),(0,P.useEffect)(()=>{var e;null===(e=r.doLayout)||void 0===e||e.call(r)},[o,l,r]);let u=t.files.some(e=>["readme","diagram"].includes(e.type)),h=()=>(0,i.jsxs)("div",{className:tT().editor,ref:a,children:[(0,i.jsx)(tD,{}),(0,i.jsx)(z.p,{tabs:n,architecture:t.architecture})]}),p=()=>(0,i.jsx)("div",{className:tT().preview,children:(0,i.jsx)(tM,{diagram:t.diagram,readme:t.readme,files:t.files})});return(0,i.jsx)("div",{className:tT().container,children:"diagram"===s?(0,i.jsx)("div",{className:tT().diagramOnly,children:p()}):u?(0,i.jsxs)(tw.o,{split:"vertical",className:tT().splitPane,resizerOptions:{hoverCss:{background:d.palette.primary.light,marginLeft:-2,width:4}},collapse:{beforeToggleButton:(0,i.jsx)("button",{children:"➡"}),afterToggleButton:(0,i.jsx)("button",{children:"⬅"}),overlayCss:{backgroundColor:"black"},collapseDirection:"right",buttonTransition:"zoom",buttonPositionOffset:-20,collapsedSize:10,collapseTransitionTimeout:350},children:[h(),p()]}):h()})});var tW=n(11703),tR=n(40044),tO=n(90948),tB=n(45187),tz=n.n(tB);let tG=(0,tO.ZP)(tW.Z)({minHeight:24,background:"#333"}),tH=(0,tO.ZP)(tR.Z)(e=>{let{theme:t}=e;return{textTransform:"none",minHeight:24,paddingTop:t.spacing(1),paddingBottom:t.spacing(1),"&.Mui-selected":{background:t.palette.secondary.dark,color:t.palette.primary.contrastText}}});function tq(e){let{children:t,value:n,index:r,...a}=e;return(0,i.jsx)("div",{className:tz().tab,role:"tabpanel",hidden:n!==r,id:"full-width-tabpanel-".concat(r),"aria-labelledby":"full-width-tab-".concat(r),...a,children:n===r&&t})}let tX=(0,k.Pi)(e=>{let{project:t,files:n}=e,{translate:r}=(0,D.q)("simulator.tabs"),a=(0,P.useContext)(z.r),{ref:o,width:l=1,height:s=1}=tS()(),[c,d]=(0,P.useState)(0);(0,P.useEffect)(()=>{var e;null===(e=a.doLayout)||void 0===e||e.call(a)},[l,s,a]);let u=(e,t)=>{d(t)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(tG,{value:c,onChange:u,variant:"fullWidth",indicatorColor:"secondary",children:[(0,i.jsx)(tH,{label:r("simulation","Simulation")}),(0,i.jsx)(tH,{label:r("code","Code")})]}),(0,i.jsxs)("div",{className:tz().container,children:[(0,i.jsx)(tq,{value:c,index:0,children:(0,i.jsx)("div",{className:tz().diagram,children:t.diagram&&(0,i.jsx)(tA.u,{diagram:t.diagram,files:t.files})})}),(0,i.jsx)(tq,{value:c,index:1,children:(0,i.jsx)("div",{className:tz().editor,ref:o,children:(0,i.jsx)(z.p,{tabs:n,architecture:t.architecture})})})]})]})});var tV=n(30873);let tK={name:"Library Manager",content:"",customComponent:(0,i.jsx)(tc,{})},tY=(0,k.Pi)(e=>{let{project:t,hex:r}=e,a=(0,P.useContext)(tf.D),o=(0,P.useContext)(z.r),l=(0,P.useContext)(eG.A),[s,c]=(0,P.useState)(o.ready),d=a.running&&a.showPioDebugger,u=(0,em.a)(),h=(0,eb.$)(),p=function(){let[e,t]=(0,P.useState)("large");return(0,P.useEffect)(()=>{let e=window.matchMedia("(max-width: 640px)"),n=window.matchMedia("(max-width: 1007px)"),i=()=>{e.matches?t("small"):n.matches?t("medium"):t("large")};return"addEventListener"in e?(e.addEventListener("change",i),n.addEventListener("change",i)):(e.addListener(i),n.addListener(i)),i(),()=>{"removeEventListener"in e?(e.removeEventListener("change",i),n.removeEventListener("change",i)):(e.removeListener(i),n.removeListener(i))}},[]),e}(),m=function(e){var t;let n=(0,P.useMemo)(()=>({name:"SD Card",content:"",customComponent:(0,i.jsx)(eD,{})}),[]);n.modified=e.sdCardFiles.some(e=>e.modified);let r=null===(t=e.diagram)||void 0===t?void 0:t.parts.find(e=>"wokwi-microsd-card"===e.type);return r?[n]:[]}(t);(0,P.useEffect)(()=>{(null==r?void 0:r.cacheKey)&&eA.I.put(r.cacheKey,r)}),function(e){let t="Leave page? Changes you made may not be saved.";(0,P.useEffect)(()=>{let n=n=>{if(Z().asPath!==n&&e&&!confirm(t))throw Z().events.emit("routeChangeError"),Z().replace(Z().asPath,Z().asPath,{shallow:!0}),"Abort route change. Please ignore this error."},i=n=>{if(e)return n.preventDefault(),n.returnValue=t,t};return window.addEventListener("beforeunload",i),Z().events.on("routeChangeStart",n),()=>{window.removeEventListener("beforeunload",i),Z().events.off("routeChangeStart",n)}},[e])}(t.modified);let b=[...t.files,...m,..."arduino"===t.projectType?[tK]:[],...d?[{name:"PIO \uD83D\uDC1B",content:"",customComponent:(0,i.jsx)(tj,{})}]:[],...a.debuggerFiles],f={userId:u.id,projectId:t.id,machineId:u.machineId,tempProjectId:t.tempId};(0,P.useEffect)(()=>{t&&s&&t.diagram&&a.start({userId:u.id,projectId:t.id,files:t.files,diagram:t.diagram,preload:!0})},[t,s,a,u.id]),o.onEditorReady=()=>{c(!0)},o.onRunCode=()=>{t.diagram&&a.start({...f,files:t.files,diagram:t.diagram})};let x=e=>{t.diagram&&a.start({...f,files:t.files,diagram:t.diagram,autoPause:!0,elf:!0,debug:e})};return o.commands.startPaused={name:"Start program paused",callback:x},o.commands.startPaused={name:"Profile program",callback:()=>{t.diagram&&a.start({...f,files:t.files,diagram:t.diagram,elf:!0,profile:!0})}},o.commands.assemblyListing={name:"View Compiled Assembly Code Listing",keybindings:e=>{let{KeyMod:t,KeyCode:n}=e;return[t.CtrlCmd|n.Backquote]},callback:()=>tk(t,a,f)},o.commands.openControlSocket={name:"Open Debug Web Socket",callback:()=>{let e=prompt("Web socket URL?","ws://localhost:2442");e&&function(e,t,n){let i=new WebSocket(e),r=[],a=!1,o=!1,l=e=>{i.send(JSON.stringify(e))};i.addEventListener("open",()=>{l({cmd:"aloha",protocol:"wokwi",version:1}),r.push((0,eT.N7)(t,"status",e=>{l({cmd:"statusChange",status:function(e){switch(e){case eI.G.Running:return"start";case eI.G.Stopped:return"stop";case eI.G.Paused:return"pause"}}(e.newValue)}),e.newValue===eI.G.Paused&&a&&l({cmd:"gdbResponse",response:t.breakpoint?eE.$_:eE.ZY})},!1))}),i.addEventListener("error",()=>{alert("Web socket connection failed!")}),i.addEventListener("close",()=>{for(let e of r)e();console.log("[Websocket] disconnected")}),i.addEventListener("message",e=>{let i;let s=e.data;try{i=JSON.parse(s)}catch(e){console.error("[Websocket] invalid message:",s);return}switch(i.cmd){case"start":{let e=i.hex,{diagram:r}=n;if(!r){console.error("[Websocket] can't start simulation: missing diagram");return}e?t.loadHex(e,r).then(()=>{t.resume()}):t.start({files:n.files,diagram:r});break}case"pause":t.pause();break;case"resume":t.resume();break;case"stop":t.stop();break;case"gdb":{a=!0,t.debugging=!0;let e=t.gdbMessage(i.message);e&&l({cmd:"gdbResponse",response:e})}break;case"serialMonitor":if(!o){var c,d;r.push(null!==(d=null===(c=t.serialRx)||void 0===c?void 0:c.subscribe(e=>{for(let t of e)l({cmd:"serialData",value:t})}))&&void 0!==d?d:()=>0),o=!0}}})}(e,a,t)}},o.commands.startGDB={name:"Start Web GDB Session (debug build)",callback:()=>{window.open("https://wokwi.github.io/web-gdb/"),x(!0),window.addEventListener("message",e=>{let t=e.data;"gdbInit"===t.type&&(console.log("GDB Attached!"),function(e,t){let n=(0,eT.N7)(e,"status",n=>{n.newValue!==eI.G.Paused||e.restarting||t.postMessage({type:"gdb",data:e.breakpoint?eE.$_:eE.ZY})},!1);e.debugging=!0,t.onmessage=n=>{let i=n.data;switch(i.type){case"break":e.pause();break;case"downloadElf":e.buildResult&&t.postMessage({type:"elf",data:e.buildResult.elf});break;case"downloadSources":var r;(null===(r=e.buildResult)||void 0===r?void 0:r.debugSources)&&t.postMessage({type:"sources",data:(0,eT.ZN)(e.buildResult.debugSources)});break;case"gdb":{let n=e.gdbMessage(i.data);n&&t.postMessage({type:"gdb",data:n})}}},t.onmessageerror=()=>{e.debugging=!1,n()}}(a,t.data))})}},o.commands.downloadHex={name:"Download Compiled Firmware",callback:async()=>{let{hex:e,hexError:n}=await a.build({...f,files:t.files,diagram:t.diagram||eL.S0.create()});if(n)alert(n);else{var i,r,o,l;if(null===(i=t.diagram)||void 0===i?void 0:null===(r=i.board)||void 0===r?void 0:r.mcuType.startsWith("esp32")){let n=t.diagram.board.mcuType;(0,ez.Sv)("firmware-".concat(n,".bin"),(0,eO.Xs)(null!==(o=null==e?void 0:e.hex)&&void 0!==o?o:""),"application/octet-stream")}else{if((null==e?void 0:e.hex)&&!(null==e?void 0:e.hex.startsWith(":"))){let t=(0,eO.Xs)(e.hex);if((0,tV.j)(t)){(0,ez.Sv)("firmware.uf2",t,"application/octet-stream");return}}(0,ez.Sv)("firmware.hex",null!==(l=null==e?void 0:e.hex)&&void 0!==l?l:"","application/octet-stream")}}}},o.commands.flash={name:"Flash firmware to device (beta)",callback:async()=>{var e,n;let i=null===(e=t.diagram)||void 0===e?void 0:null===(n=e.board)||void 0===n?void 0:n.mcuType;if(!(null==i?void 0:i.startsWith("esp32"))){alert("This feature is only available for ESP32 boards");return}let{hex:r,hexError:o}=await a.build({...f,files:t.files,diagram:t.diagram||eL.S0.create()});if(o)alert(o);else if(r){let e="".concat(r.cacheKey,"-").concat(new Date().getTime());window.open("https://flasher-esp32.apps.wokwi.com/?mcu=".concat(i,"&build=").concat(e)),window.addEventListener("message",t=>{let n=t.data,i=n.port;if("loadBinary"===n.type&&n.build===e){var a;let e=(0,eO.Xs)(null!==(a=null==r?void 0:r.hex)&&void 0!==a?a:"");i.postMessage({type:"flash",binaries:[{offset:65536,data:e.buffer}]},{transfer:[e.buffer]})}})}}},o.commands.downloadUF2={name:"Download UF2 Binary",callback:async()=>{let e=n.e(3215).then(n.bind(n,43215)),{hex:i,hexError:r}=await a.build({...f,files:t.files,diagram:t.diagram||eL.S0.create()}),{hexToUF2:o}=await e;if(r)alert(r);else{var l;(0,ez.Sv)("firmware.uf2",o(null!==(l=null==i?void 0:i.hex)&&void 0!==l?l:""),"application/octet-stream")}}},o.commands.downloadELF={name:"Download ELF with Debugging Symbols",callback:async()=>{let{hex:e,hexError:n}=await a.build({...f,files:t.files,diagram:t.diagram||eL.S0.create(),elf:!0,debug:!0});if(n)alert(n);else{var i;(0,ez.Sv)("firmware.elf",(0,eO.Xs)(null!==(i=null==e?void 0:e.elf)&&void 0!==i?i:""),"application/octet-stream")}}},o.commands.simulateHex={name:"Load HEX File and Start Simulation...",callback:()=>{alert('This command has been renamed to "Upload Firmware and Start Simulation…"')}},o.commands.uploadFirmware={name:"Upload Firmware and Start Simulation…",callback:async()=>{let{files:e}=await (0,ek.aE)({}),n=null==e?void 0:e[0];if(!n)return;let i=n.name.toLowerCase(),r=i.endsWith(".hex"),o=await (r?(0,ek.Ve)(n):(0,ek.DT)(n));t.diagram&&a.start({...f,files:t.files,diagram:t.diagram,autoPause:i.includes("-pause."),sideHex:o})}},o.commands.loadCustomChipC={name:"Create a custom C chip (beta)",callback:async()=>{if(t.files.find(e=>e.name===eF)){alert("File ".concat(eF," already exists, please edit it."));return}t.addFile(eF,eM),t.files.find(e=>e.name===eU)||t.addFile(eU,eW);let e=t.diagram;if(!e)return;let n="chip-"+eU.split(".")[0];e.parts.find(e=>e.type===n)||(e.addPartFromTemplate({type:n,prefix:"chip",attrs:[]}),t.syncDiagram())}},o.commands.chipAPITracing={name:"Enable Chip API Tracing",callback:async()=>{(0,eN.O)()}},o.commands.loadCustomBoard={name:"Load custom board file...",callback:async()=>{let{files:e}=await (0,ek.aE)({directory:!0}),n=[...e],i=n.find(e=>"board.json"===e.name),r=n.find(e=>"board.svg"===e.name);if(!i){alert("Error: missing board.json!");return}if(!r){alert("Error: missing board.svg!");return}let[a,o]=await Promise.all([(0,ek.Ve)(i),(0,ek.Ve)(r)]);h.loadUserBoard(a,o),t.syncDiagram(),l.fit()}},o.commands.downloadPcap={name:"Download WiFi Packet Capture (PCAP) file",callback:async()=>{let{wifi:e}=a;if(!e||!e.medium.frames.length){alert("No clients connect to the virtual WiFi");return}e.medium.downloadPcap()}},o.commands.enableGateway={name:"Enable Private Wokwi IoT Gateway",callback:()=>{if(!(0,eR.Wl)(u)){alert("This feature is only available for Wokwi Club members: https://wokwi.com/club");return}let e=confirm("Enable local Wokwi IoT Gateway?");(0,eR.VE)(e)}},o.commands.enablePrivateBuild={name:"Enable private build server",callback:()=>{let e=prompt("Build server name? (empty to disable)","");if(e&&"PIAI-df68d5f0"!==e&&"localhexi"!==e){alert("Unknown build server");return}localStorage.removeItem("__buildServer"),localStorage.removeItem("__hexi"),"localhexi"===e?localStorage.setItem("__hexi","http://localhost:4055"):e&&localStorage.setItem("__buildServer",e)}},(0,eB.Uf)()&&(o.commands.loadLocalLibraries={name:"Select local Arduino libraries directory",callback:async()=>{let e=await (0,eB.Y1)();e&&(a.localLibraryDirectory=e)}}),"small"===p?(0,i.jsx)(tX,{project:t,files:b}):(0,i.jsx)(tU,{project:t,files:b})});var tJ=n(9371),tQ=n.n(tJ);let t$=(0,j.Z)(h.Z)({height:48}),t0=(0,k.Pi)(e=>{let{project:t,embedMode:n}=e,[a,h]=(0,P.useState)(!1),[j,k]=(0,P.useState)(!1),[y,_]=(0,P.useState)(!1),[Z,F]=(0,P.useState)(!1),[M,U]=(0,P.useState)(!1),W=(0,L.A)(),[R]=(0,P.useState)({ready:!1,embedMode:n||W.embed,commands:{}}),X=(0,P.useContext)(tf.D),V=(0,P.useContext)(T.St),{translate:K}=(0,D.q)("project"),Y=(0,C.useRouter)();(0,P.useEffect)(()=>{(0,N.f)()},[]),(0,P.useEffect)(()=>{V.token&&t.updateFromServer(V)},[t,V,V.token]);let{hatcheryEgg:J}=W;(0,P.useEffect)(()=>{J&&t.loadEgg(J)},[t,J]);let Q=async()=>{if(t.locked){alert(K("error.saveFailed","Save failed: project is locked!"));return}if(!t.name){F(!0);return}if(!en){U(!0);return}h(!0);try{await (0,A.UI)(V,t,!1),t.setPristine()}finally{h(!1)}},$=async e=>{h(!0);try{t.setName(e);let n=await (0,A.UI)(V,t,!0);t.changeId(n.projectId),t.changeOwner(n.owner),t.setPristine(),Y.push("/projects/".concat(t.id),void 0,{shallow:!0})}finally{h(!1)}},ee=async()=>{if(!V.loggedIn){alert(K("error.signInToLikeProject","Please sign-in to Like this project."));return}if(!t||!t.id)return;let e=!t.userLiked;t.updateUserLike(e),t.updateHearts((await (0,A.$v)(V,t.id,e)).hearts),(0,I.L)({action:e?"like":"unlike",category:"project",label:t.name})};R.onSaveCode=Q,(0,P.useEffect)(()=>()=>{X.closeProject()},[t,X]);let et=t.id?(0,E.m)("https://wokwi.com/share/".concat(t.id),t.updated):null,en=t.owner&&t.owner===V.id,{ownerUsername:ei}=t;return(0,i.jsxs)(H._,{children:[(0,i.jsx)(w(),{children:et&&(0,i.jsx)("link",{rel:"alternate",type:"application/json+oembed",href:et,title:"Wokwi oEmbed provider"})}),(0,i.jsx)(G.r,{children:(0,i.jsxs)("div",{className:tQ().topButtons,children:[(0,i.jsxs)(O,{size:"small",onClick:Q,disabled:!t.modified||a||t.locked,variant:"contained",text:(0,i.jsx)(p.Z,{component:"span",sx:{display:{xs:"none",sm:"initial"}},children:K("header.save","Save")}),startIcon:a?(0,i.jsx)(o(),{path:r.CEZ,size:1,spin:!0}):(0,i.jsx)(o(),{path:r.Tls,size:1}),children:[(0,i.jsxs)(B,{children:[(0,i.jsxs)(t$,{onClick:()=>k(!0),disabled:a,sx:{display:{xs:"block",sm:"none"}},children:[(0,i.jsx)("div",{className:tQ().buttonIcon,children:(0,i.jsx)(o(),{path:r.dGe,size:1})}),K("header.share","Share")]}),(0,i.jsxs)(t$,{disabled:null==t.id,onClick:()=>U(!0),children:[(0,i.jsx)("div",{className:tQ().buttonIcon,children:(0,i.jsx)(l.Z,{})}),(0,i.jsx)(m.Z,{children:K("menu.saveACopy","Save a copy")})]})]}),en&&(0,i.jsx)(t$,{children:(0,i.jsx)(b.Z,{control:(0,i.jsx)(f.Z,{name:"lock",checkedIcon:(0,i.jsx)(s.Z,{}),icon:(0,i.jsx)(c.Z,{}),checked:t.locked,onChange:(e,n)=>{t.setLocked(n),(0,A.ty)(V,t)}}),label:K("menu.lockProject","Lock project")})}),(0,i.jsxs)(t$,{onClick:()=>(0,N.r)(t),children:[(0,i.jsx)("div",{className:tQ().buttonIcon,children:(0,i.jsx)(o(),{path:r.OGU,size:1})}),(0,i.jsx)(m.Z,{children:K("menu.downloadProjectZip","Download project ZIP")})]})]}),(0,i.jsx)(x.Z,{size:"small",className:tQ().button,sx:{display:{xs:"none",sm:"flex"}},onClick:()=>k(!0),disabled:a,variant:"contained",startIcon:(0,i.jsx)(o(),{path:r.dGe,size:1}),children:K("header.share","Share")}),t.isDBProject&&(0,i.jsx)(g.Z,{title:t.userLiked?K("header.unlikeProjectTooltip","Unlike this project"):K("header.likeProjectTooltip","Like this project"),children:(0,i.jsx)(v.Z,{onClick:ee,color:t.userLiked?"primary":"default",size:"large",children:(0,i.jsx)(d.Z,{})})}),(en||ei)&&(0,i.jsxs)(p.Z,{mx:1,sx:{position:"relative",lineHeight:1.2,display:{xs:"none",md:"block"}},children:[t.name," ",(0,i.jsx)(v.Z,{size:"small",sx:{position:"absolute",top:-4},onClick:()=>_(!0),children:(0,i.jsx)(u.Z,{})}),ei&&(0,i.jsxs)("div",{children:["by"," ",(0,i.jsx)(S(),{href:"/makers/[maker]",as:"/makers/".concat(ei),children:ei})]})]})]})}),y&&(0,i.jsx)(q.i,{project:t,isOpen:y,onClose:()=>_(!1)}),(0,i.jsx)(es,{project:t,isOpen:Z,onClose:()=>F(!1),onSaveClick:$}),(0,i.jsx)(el,{project:t,isOpen:M,onClose:()=>U(!1),onSaveCopyClick:$}),(0,i.jsx)(ep,{open:j,project:t,onClose:()=>k(!1),saving:a,onSaveProject:()=>F(!0)}),(0,i.jsx)("main",{className:tQ().main,children:(0,i.jsx)(ey.x.Provider,{value:t,children:(0,i.jsx)(z.r.Provider,{value:R,children:(0,i.jsx)(tY,{project:t})})})})]})})},18335:function(e,t,n){"use strict";n.d(t,{h7:function(){return r},yz:function(){return i}}),n(54619);let i={"AccelStepper.h":"AccelStepper","Adafruit_GFX.h":"Adafruit GFX Library","Adafruit_INA219.h":"Adafruit INA219","Adafruit_LEDBackpack.h":"Adafruit LED Backpack Library","Adafruit_MPU6050.h":"Adafruit MPU6050","Adafruit_NeoMatrix.h":"Adafruit NeoMatrix","Adafruit_NeoPixel.h":"Adafruit NeoPixel","Adafruit_SoftServo.h":"Adafruit SoftServo","Adafruit_ST7789.h":"Adafruit ST7735 and ST7789 Library","Adafruit_ST7735.h":"Adafruit ST7735 and ST7789 Library","Adafruit_ILI9341.h":"Adafruit ILI9341","Adafruit_Sensor.h":"Adafruit Unified Sensor","Adafruit_SSD1306.h":"Adafruit SSD1306","ArduinoJson.h":"ArduinoJson","BasicLinearAlgebra.h":"BasicLinearAlgebra","basicMPU6050.h":"basicMPU6050","blinker.h":"LC_baseTools","Bounce2.h":"Bounce2","Button.h":"Button","DallasTemperature.h":"DallasTemperature","dht.h":"DHTlib","DHT.h":"DHT sensor library","DHT_U.h":"DHT sensor library","DHTesp.h":"DHT sensor library for ESPx","DS3231.h":"DS3231","EEPROM.h":"EEPROM","Encoder.h":"Encoder","FastLED.h":"FastLED","FastLED_NeoMatrix.h":"FastLED NeoMatrix","FixedPoints.h":"FixedPoints","Geometry.h":"Geometry","I2Cdev.h":"MPU6050","idlers.h":"LC_baseTools","IRremote.h":"IRremote","IRremoteInt.h":"IRremote","Key.h":"Keypad","Keypad.h":"Keypad","lcdgfx.h":"lcdgfx","LedControl.h":"LedControl","lilParser.h":"LC_lilParser","LiquidCrystal.h":"LiquidCrystal","LiquidCrystal_I2C.h":"LiquidCrystal I2C","LiquidMenu.h":"LiquidMenu","MD_MAX72xx.h":"MD_MAX72XX","MD_Parola.h":"MD_Parola","mechButton.h":"LC_baseTools","Midier.h":"Midier","MPU6050.h":"MPU6050","MultiStepper.h":"AccelStepper","OneButton.h":"OneButton","OneWire.h":"OneWire","qrcode.h":"QRCode","PID_v1.h":"PID","pitches.h":"PlayRtttl","PlayRtttl.h":"PlayRtttl","protothreads.h":"Protothreads","pt.h":"Protothreads","RTClib.h":"RTClib","runningAvg.h":"LC_baseTools","SD.h":"SD","SdFat.h":"SdFat","Segment.h":"Segment","Servo.h":"Servo","ServoEasing.h":"ServoEasing","SevSeg.h":"SevSeg","ShiftDisplay.h":"ShiftDisplay","SimpleDHT.h":"SimpleDHT","SimpleTimer.h":"SimpleTimer","SoftwareSerial.h":"SoftwareSerial","SPI.h":"SPI","ssd1306.h":"ssd1306","SSD1306Ascii.h":"SSD1306Ascii","SSD1306AsciiWire.h":"SSD1306Ascii","SSD1306init.h":"SSD1306Ascii","Stepper.h":"Stepper","Talkie.h":"Talkie","TaskScheduler.h":"TaskScheduler","TimeLib.h":"Time","timeObj.h":"LC_baseTools","TimerOne.h":"TimerOne","Tiny4kOLED.h":"Tiny4kOLED","TinyDebug.h":"TinyDebug","TinyWireM.h":"TinyWireM","TM1637TinyDisplay.h":"TM1637TinyDisplay","U8glib.h":"U8glib","U8g2lib.h":"U8g2","U8x8lib.h":"U8g2","Ultrasonic.h":"Ultrasonic","VarSpeedServo.h":"VarSpeedServo","WiFiNINA.h":"WiFiNINA","Wire.h":"Wire"};function r(e){let t=e.matchAll(/(^|\n)\s*#include\s*[<"]([^.]+\.h)[">]/g);return Array.from(t).map(e=>e[2])}},92920:function(e,t,n){"use strict";function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return"https://wokwi.com/api/oembed?url=".concat(encodeURIComponent(e),"&t=").concat(t.getTime(),"}")}n.d(t,{m:function(){return i}})},93545:function(e,t,n){"use strict";function i(e){return{sidesetCount:e>>29&7,sideEn:!!(1073741824&e)}}function r(e){let{sidesetCount:t,sideEn:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i(0),r=[],a=[];for(let i=0;i<e.length;i++){let o=e[i],l=o>>8&31,s=l&(1<<5-t)-1,c=function(e){let t=255&e;switch(e>>>13){case 0:{let e={0:"",1:"!x",2:"x--",3:"!y",4:"y--",5:"x!=y",6:"pin",7:"!osre"}[t>>5];return"jmp ".concat(e?e+", ":"").concat(31&t)}case 1:{let e={0:"gpio",1:"pin",2:"irq",3:"reserved"}[t>>5&3];return"wait ".concat(128&t?"1":"0"," ").concat(e," ").concat("irq"===e?7&t:31&t).concat("irq"===e&&16&t?" rel":"")}case 2:return"in ".concat({0:"pins",1:"x",2:"y",3:"null",4:"reserved",5:"reserved",6:"isr",7:"osr"}[t>>5],", ").concat(31&t||32);case 3:return"out ".concat({0:"pins",1:"x",2:"y",3:"null",4:"pindirs",5:"pc",6:"isr",7:"exec"}[t>>5],", ").concat(31&t||32);case 4:{let e=32&t?"":" noblock",n=64&t;if(128&t)return"pull".concat(n?" ifempty":"").concat(e);return"push".concat(n?" iffull":"").concat(e)}case 5:{let e={0:"pins",1:"x",2:"y",3:"null",4:"reserved",5:"status",6:"isr",7:"osr"}[7&t],n=t>>3&3,i={0:"pins",1:"x",2:"y",3:"reserved",4:"exec",5:"pc",6:"isr",7:"osr"}[t>>5&7];if(e===i&&0===n)return"nop";return"mov ".concat(i,", ").concat(0===n?"":1===n?"~":2===n?"::":"").concat(e)}case 6:if(128&t)break;return"irq".concat(64&t?" clear":"").concat(32&t?" wait":""," ").concat(7&t).concat(16&t?" rel":"");case 7:return"set ".concat({0:"pins",1:"x",2:"y",4:"pindirs"}[t>>5],", ").concat(31&t)}return".data ".concat(e.toString(16))}(o);if(t&&(!n||16&l)){let e=l>>5-t;n&&(e&=(1<<t-1)-1),c+=" .side(".concat(e,")")}s&&(c+=" [".concat(s,"]")),r[i]={address:i,text:c,label:!1},o>>13==0&&a.push(31&o)}for(let e of a)r[e]&&(r[e].label=!0);return r}n.d(t,{C:function(){return r},k:function(){return i}})},30873:function(e,t,n){"use strict";n.d(t,{G:function(){return o},j:function(){return a}});var i=n(16686);let r="wokwidbg;v1;";function a(e){return e.length>=512&&(0,i.ul)(new Uint8Array(e.buffer.slice(0,512)))}function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=n+e.length,l=!1;for(let s=0;s<t.length;s+=512){let c=(0,i.tj)(t.subarray(s,s+512)),{flashAddress:d,payload:u,flags:h}=c;if(d>=n&&d<o&&(e.set(u,d-n),l=!0),h&i.Bt.notMainFlash){let e=String.fromCharCode.apply(null,Array.from(u));e.startsWith(r)&&a.push(e.substring(r.length))}}return l}},6593:function(e,t,n){"use strict";function i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return function(e,t,n){for(;e.length<t;)e=n+e;return e}(e.toString(),t,n)}n.d(t,{Gt:function(){return i}})},67449:function(e){e.exports={debugBar:"debugger-toolbar_debugBar__2_YwV",button:"debugger-toolbar_button__dSqes",disabled:"debugger-toolbar_disabled__E_Xo5",stopButton:"debugger-toolbar_stopButton__fwKbF"}},62042:function(e){e.exports={toolbar:"header-small_toolbar__as_Xd",logo:"header-small_logo__700Lg",menu:"header-small_menu__g1j0W",spacer:"header-small_spacer__ctq8S"}},24889:function(e){e.exports={debugger:"pio-debugger_debugger__FmzYe",current:"pio-debugger_current__DOX_g",listing:"pio-debugger_listing__qMfqG",lineNumber:"pio-debugger_lineNumber__bwbeZ",breakpoint:"pio-debugger_breakpoint__2hlYE",registers:"pio-debugger_registers__4PqDz",fifo:"pio-debugger_fifo__LpGn8"}},95384:function(e){e.exports={modalContent:"share-modal_modalContent__biXYr",shareLinkContainer:"share-modal_shareLinkContainer__TA_bA"}},9371:function(e){e.exports={topButtons:"project-page_topButtons__g_rp4",main:"project-page_main__3R7nS",button:"project-page_button__uUM7a",buttonIcon:"project-page_buttonIcon__lbsgh"}},41264:function(e){e.exports={splitPane:"workbench-desktop_splitPane__B0r3f",container:"workbench-desktop_container__c61v2",editor:"workbench-desktop_editor__L4Jxo",preview:"workbench-desktop_preview__Eeuqi",diagramOnly:"workbench-desktop_diagramOnly__d81uo"}},45187:function(e){e.exports={container:"workbench-mobile_container__QXVNe",tab:"workbench-mobile_tab__lFXw9",editor:"workbench-mobile_editor__IOH7W",diagram:"workbench-mobile_diagram__4pv_n"}}}]);